!function(t){t.fn.featureCarousel=function(e){return e=t.extend({},t.fn.featureCarousel.defaults,e||{}),t(this).each(function(){function a(a){if(1==e.preload){var i=C.featuresContainer.find("img"),r=0,n=i.length;i.each(function(){t(this).load(function(){r++,r==n&&a()}),this.complete&&t(this).trigger("load")})}else a()}function i(t){return C.featuresArray[t-1]}function r(t){return t-1==0?C.totalFeatureCount:t-1}function n(t){return t+1>C.totalFeatureCount?1:t+1}function u(){C.containerWidth=C.featuresContainer.width(),C.containerHeight=C.featuresContainer.height();var a=t(C.containerIDTag).find("div img:first");C.largeFeatureWidth=e.largeFeatureWidth>1?e.largeFeatureWidth:e.largeFeatureWidth>0&&e.largeFeatureWidth<1?a.width()*e.largeFeatureWidth:a.outerWidth(),C.largeFeatureHeight=e.largeFeatureHeight>1?e.largeFeatureHeight:e.largeFeatureHeight>0&&e.largeFeatureHeight<1?a.height()*e.largeFeatureHeight:a.outerHeight(),C.smallFeatureWidth=e.smallFeatureWidth>1?e.smallFeatureWidth:e.smallFeatureWidth>0&&e.smallFeatureWidth<1?a.width()*e.smallFeatureWidth:a.outerWidth()/2,C.smallFeatureHeight=e.smallFeatureHeight>1?e.smallFeatureHeight:e.smallFeatureHeight>0&&e.smallFeatureHeight<1?a.height()*e.smallFeatureHeight:a.outerHeight()/2}function o(){e.displayCutoff>0&&e.displayCutoff<C.totalFeatureCount&&(C.totalFeatureCount=e.displayCutoff),C.featuresContainer.children("div").each(function(e){e<C.totalFeatureCount&&(C.featuresArray[e]=t(this))}),"medium"!=C.featuresContainer.children("div").first().css("borderLeftWidth")&&(C.borderWidth=2*parseInt(C.featuresContainer.children("div").first().css("borderLeftWidth"))),C.featuresContainer.children("div").each(function(){t(this).css({left:C.containerWidth/2-C.smallFeatureWidth/2-C.borderWidth/2,width:C.smallFeatureWidth,height:C.smallFeatureHeight,top:e.smallFeatureOffset+e.topPadding,opacity:0})}).find("img:first").css({width:C.smallFeatureWidth}),C.itemsToAnimate=C.totalFeatureCount<4?C.totalFeatureCount:4,C.featuresContainer.find("div > div").hide()}function s(){t.each(C.featuresArray,function(e){t(this).data("setPosition",e+1)});var a=r(e.startingFeature);C.currentCenterNum=a;var n=i(a);n.data("position",1);var u=n.prevAll();u.each(function(e){t(this).data("position",C.totalFeatureCount-e)});var o=n.nextAll();o.each(function(e){void 0!=t(this).data("setPosition")&&t(this).data("position",e+2)}),3==e.counterStyle&&t.each(C.featuresArray,function(){var e=r(t(this).data("position")),a=t("<span></span>");a.addClass("numberTag"),a.html("("+e+" of "+C.totalFeatureCount+") "),t(this).find("div p").prepend(a)})}function l(){}function d(t,e){var a=C.featuresContainer.find(".blipsContainer"),i=a.find("#blip_"+t),r=a.find("#blip_"+e);i.removeClass("blipSelected"),r.addClass("blipSelected")}function h(){if(null!=C.timeoutVar&&(C.timeoutVar=clearTimeout(C.timeoutVar)),0!=e.autoPlay){var t=Math.abs(e.autoPlay)<e.carouselSpeed?e.carouselSpeed:Math.abs(e.autoPlay);C.timeoutVar=setTimeout(function(){e.autoPlay>0?m(!0,1):e.autoPlay<0&&m(!1,1)},t)}}function c(e){t.each(C.featuresArray,function(){var a;a=0==e?n(t(this).data().position):r(t(this).data().position),t(this).data("position",a)})}function f(t,a){var i,u,o,s,l,f,m,F=t.data("position");m=1==a?r(F):n(F),1==m?(i=C.largeFeatureWidth,u=C.largeFeatureHeight,o=e.topPadding,l=t.css("z-index"),s=C.containerWidth/2-C.largeFeatureWidth/2-C.borderWidth/2,f=1):(i=C.smallFeatureWidth,u=C.smallFeatureHeight,o=e.smallFeatureOffset+e.topPadding,l=1,f=1,m==C.totalFeatureCount?s=e.sidePadding:2==m?s=C.containerWidth-C.smallFeatureWidth-e.sidePadding-C.borderWidth:(s=C.containerWidth/2-C.smallFeatureWidth/2-C.borderWidth/2,f=0)),1!=m&&t.find("div").hide(),t.animate({width:i,height:u,top:o,left:s,opacity:f},e.carouselSpeed,e.animationEasing,function(){if(1==m&&t.find("div").fadeTo("fast",1),C.rotationsRemaining=C.rotationsRemaining-1,t.css("z-index",l),(1==e.counterStyle||2==e.counterStyle)&&1==m){var i,u=C.featuresContainer.children("div").index(t)+1;i=0==a?n(u):r(u),d(i,u)}var o=C.rotationsRemaining/C.itemsToAnimate;o%1==0&&(C.currentlyMoving=!1,c(a),C.rotationsRemaining>0&&g(a)),h()}).find("img:first").animate({width:i,height:u},e.carouselSpeed,e.animationEasing).end()}function g(t){C.currentlyMoving=!0;var e,a,u,o;1==t?(e=i(n(C.currentCenterNum)),a=i(C.currentCenterNum),u=i(n(n(C.currentCenterNum))),o=i(r(C.currentCenterNum)),C.currentCenterNum=n(C.currentCenterNum)):(e=i(r(C.currentCenterNum)),a=i(r(r(C.currentCenterNum))),u=i(C.currentCenterNum),o=i(n(C.currentCenterNum)),C.currentCenterNum=r(C.currentCenterNum)),t?a.css("z-index",3):u.css("z-index",3),e.css("z-index",4),f(a,t),f(e,t),f(u,t),C.totalFeatureCount>3&&f(o,t)}function m(t,e){if(0==C.currentlyMoving){var a=e*C.itemsToAnimate;C.rotationsRemaining=a,g(t)}}function F(t,e){var a,i=1,u=1;for(a=t;(a=r(a))!=e;)i++;for(a=t;(a=n(a))!=e;)u++;return u>i?-1*i:u}var C={currentCenterNum:e.startingFeature,containerWidth:0,containerHeight:0,largeFeatureWidth:0,largeFeatureHeight:0,smallFeatureWidth:0,smallFeatureHeight:0,totalFeatureCount:t(this).children("div").length,currentlyMoving:!1,featuresContainer:t(this),featuresArray:[],containerIDTag:"#"+t(this).attr("id"),timeoutVar:null,rotationsRemaining:0,itemsToAnimate:0,borderWidth:0};a(function(){u(),o(),s(),l(),m(!0,1)}),t(".leftButton").click(function(){m(!1,1)}),t(".rightButton").click(function(){m(!0,1)}),C.featuresContainer.children("div").click(function(){var e=t(this).data("position");2==e?m(!0,1):e==C.totalFeatureCount&&m(!1,1)}).mouseover(function(){if(0==C.currentlyMoving){var e=t(this).data("position");(2==e||e==C.totalFeatureCount)&&t(this).css("opacity",1)}}).mouseout(function(){if(0==C.currentlyMoving){var e=t(this).data("position");(2==e||e==C.totalFeatureCount)&&t(this).css("opacity",1)}}),t("a",C.containerIDTag).on("click",function(e){var a=t(this).parentsUntil(C.containerIDTag);a.each(function(){var a=t(this).data("position");return void 0!=a&&1!=a?(a==C.totalFeatureCount?m(!1,1):2==a&&m(!0,1),e.preventDefault(),!1):void 0})}),t(".blip").on("click",function(){var e=t(this).attr("id").substring(5),a=C.featuresContainer.children("div").eq(e-1).data("position"),i=C.currentCenterNum;if(e!=i){var r=F(1,a);0>r?m(!1,-1*r):m(!0,r)}})})},t.fn.featureCarousel.defaults={largeFeatureWidth:0,largeFeatureHeight:0,smallFeatureWidth:.85,smallFeatureHeight:.85,topPadding:20,sidePadding:0,smallFeatureOffset:27,startingFeature:1,carouselSpeed:500,autoPlay:3e3,counterStyle:1,preload:!0,displayCutoff:0,animationEasing:"swing"},t("#featureCarousel").featureCarousel({})}(jQuery);